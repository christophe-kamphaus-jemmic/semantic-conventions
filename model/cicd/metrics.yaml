groups:
  - id: metric.cicd.pipeline.run.duration
    type: metric
    metric_name: cicd.pipeline.run.duration
    brief: 'Duration of a pipeline run grouped by pipeline and result.'
    instrument: histogram
    unit: "s"
    stability: experimental
    attributes:
      - ref: cicd.pipeline.name
        requirement_level: required
      - ref: cicd.pipeline.result
        requirement_level: required
      - ref: error.type
        requirement_level:
          conditionally_required: If and only if the pipeline run failed.
  - id: metric.cicd.pipeline.run.active
    type: metric
    metric_name: cicd.pipeline.run.active
    brief: 'The number of pipeline runs currently executing.'
    instrument: updowncounter
    unit: "{run}"
    stability: experimental
    attributes:
      - ref: cicd.pipeline.name
        requirement_level: required
  - id: metric.cicd.pipeline.run.time_in_queue
    type: metric
    metric_name: cicd.pipeline.run.time_in_queue
    brief: 'The duration a pipeline run takes from being triggered to the start of execution.'
    instrument: histogram
    unit: "s"
    stability: experimental
    attributes:
      - ref: cicd.pipeline.name
        requirement_level: recommended
  - id: metric.cicd.queue.length
    type: metric
    metric_name: cicd.queue.length
    brief: 'The number of pipeline runs waiting for their start of execution.'
    instrument: updowncounter
    unit: "{run}"
    stability: experimental
    attributes:
      - ref: cicd.pipeline.name
        requirement_level: recommended
  - id: metric.cicd.worker.count
    type: metric
    metric_name: cicd.worker.count
    brief: 'The number of workers on the CICD system by class and status.'
    instrument: updowncounter
    unit: "{count}"
    stability: experimental
    attributes:
      - ref: cicd.worker.class
        requirement_level: required
      - ref: cicd.worker.state
        requirement_level: required
  - id: metric.cicd.pipeline.run.errors
    type: metric
    metric_name: cicd.pipeline.run.errors
    brief: 'The number of errors encountered in pipeline runs (eg. compile, test failures).'
    instrument: counter
    unit: "{error}"
    stability: experimental
    attributes:
      - ref: cicd.pipeline.name
        requirement_level: required
      - ref: error.type
        requirement_level: required
  - id: metric.cicd.system.errors
    type: metric
    metric_name: cicd.system.errors
    brief: 'The number of errors in a component of the CICD system (eg. controller, scheduler, agent).'
    note: 'Errors in pipeline run execution are explicitly excluded. Ie a test failure is not counted in this metric.'
    instrument: counter
    unit: "{error}"
    stability: experimental
    attributes:
      - ref: cicd.system.component
        requirement_level: required
      - ref: error.type
        requirement_level: required
